# =============================================================================
# OVERLEAF-LAB UNIFIED CONFIGURATION
# =============================================================================
# This file contains all configuration for the complete Overleaf+Zotero system
#
# INSTRUCTIONS:
# 1. Copy this file to config.env.local (git-ignored)
# 2. Fill in all values below
# 3. Run ./install.sh to apply configuration and install everything
# =============================================================================

# -----------------------------------------------------------------------------
# GENERAL SETTINGS
# -----------------------------------------------------------------------------
LAB_NAME="Your Lab Name"
ADMIN_EMAIL="admin@your-domain.com"

# Enable public Zotero signup page? (true/false)
# The dashboard is always installed for admin management of Overleaf users and Zotero integration.
# This setting controls whether to expose the public /signup page via Cloudflare Tunnel:
# - Set to "true" to allow public Zotero self-registration (users can sign up via web form)
# - Set to "false" to keep signup private (admin must configure Zotero users manually via dashboard)
ENABLE_PUBLIC_ZOTERO_SIGNUP="false"

# Public URLs
# - For local testing: http://localhost
# - For production with HTTPS/reverse proxy: https://your-domain.com
OVERLEAF_URL="http://localhost"
DASHBOARD_URL="http://localhost:5000"

# Behind reverse proxy with HTTPS? (true/false)
# - Set to "false" for local testing (http://localhost)
# - Set to "true" for production with HTTPS and reverse proxy
BEHIND_PROXY="false"

# Use secure cookies? (true/false)
# IMPORTANT: Must be "false" if using HTTP (without HTTPS)
# - Set to "false" for local testing (http://localhost)
# - Set to "true" for production with HTTPS
USE_SECURE_COOKIES="false"

# -----------------------------------------------------------------------------
# OVERLEAF CONFIGURATION
# -----------------------------------------------------------------------------
# Compile timeout in seconds (default: 180 = 3 minutes)
COMPILE_TIMEOUT="180"

# Enable sandboxed compiles (isolates each compile in a separate container for security)
SANDBOXED_COMPILES="true"

# Enable track changes (true/false)
TRACK_CHANGES_ENABLED="true"

# Overleaf port (default: 80, or 300 for custom)
OVERLEAF_PORT="80"

# Password validation (passfield format)
# Pattern: a=lowercase, A=uppercase, 1=number, $=symbol
# Example: "a1$" requires 1 letter, 1 number, 1 symbol
PASSWORD_VALIDATION_PATTERN="a1$"
PASSWORD_VALIDATION_MIN_LENGTH="8"

# Maximum upload size in bytes (default: 524288000 = 500MB)
MAX_UPLOAD_SIZE="524288000"

# Enabled linked file types
ENABLED_LINKED_FILE_TYPES="project_file,project_output_file,url"

# Dashboard signup URL (for Zotero integration link)
# Change this to your actual signup page URL
DASHBOARD_SIGNUP_URL="http://localhost:5000/zotero/signup"

# Signup subdomain for auto-redirect (set by cloudflare tunnel script)
# When visitors access this subdomain, they're redirected to /zotero/signup
SIGNUP_SUBDOMAIN=""

# Docker image to use
# - Default: overleafcep/sharelatex (Extended CE with premium features)
# - After LaTeX install: local/sharelatex-texlive-full
OVERLEAF_IMAGE="overleafcep/sharelatex"
OVERLEAF_IMAGE_TAG="6.0.0-ext-v3.2"

# MongoDB version
# Use "8.0" for modern CPUs (default)
# Use "4.4" for older CPUs without AVX support (pre-2011 Intel, pre-2012 AMD)
MONGO_VERSION="8.0"

# Data paths (relative to installation directory)
OVERLEAF_DATA_PATH="./data/overleaf"
MONGO_DATA_PATH="./data/mongo"
REDIS_DATA_PATH="./data/redis"

# Sandboxed compiles paths (absolute - will be set during install)
SANDBOXED_COMPILES_HOST_DIR_COMPILES=""
SANDBOXED_COMPILES_HOST_DIR_OUTPUT=""

# -----------------------------------------------------------------------------
# EMAIL CONFIGURATION (SMTP)
# -----------------------------------------------------------------------------
EMAIL_FROM_ADDRESS="noreply@your-domain.com"

# SMTP Settings
SMTP_HOST="smtp.your-provider.com"
SMTP_PORT="587"
SMTP_SECURE="false"
SMTP_USER="your-smtp-username"
SMTP_PASS="your-smtp-password"
SMTP_TLS_REJECT_UNAUTH="true"
SMTP_IGNORE_TLS="false"

# Disable email confirmation requirement (true/false)
EMAIL_CONFIRMATION_DISABLED="true"

# -----------------------------------------------------------------------------
# DASHBOARD (overleaf-zotero-manager) CONFIGURATION
# -----------------------------------------------------------------------------
# Flask secret key (GENERATE with: python3 -c 'import secrets; print(secrets.token_hex(32))')
FLASK_SECRET_KEY=""

# Dashboard admin credentials
DASHBOARD_ADMIN_PASSWORD=""  # CHANGE THIS!

# Flask settings
FLASK_DEBUG="False"
FLASK_PORT="5000"

# MongoDB connection (leave as-is for docker setup)
MONGODB_URI="mongodb://mongo:27017/sharelatex?directConnection=true"

# Zotero proxy Docker image name
ZOTERO_PROXY_IMAGE="zotero-overleaf-proxy:local"

# Session security (for Dashboard)
# IMPORTANT: SESSION_COOKIE_SECURE must be "False" if using HTTP (without HTTPS)
# - Set to "False" for local testing (http://localhost)
# - Set to "True" for production with HTTPS
SESSION_COOKIE_SECURE="False"
SESSION_COOKIE_HTTPONLY="True"
SESSION_COOKIE_SAMESITE="Lax"

# Logging
LOG_LEVEL="INFO"
LOG_FILE="logs/app.log"

# NOTE: Individual Zotero users will be added via the dashboard web UI
